@using System.Security.Claims
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>SocialV - @ViewData["Title"]</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true"/>
    <link rel="stylesheet" href="~/PRN221_Assignment.styles.css" asp-append-version="true"/>
    <link rel="shortcut icon" href="~/assets/images/favicon.ico"/>
    <link rel="stylesheet" href="~/assets/css/libs.min.css">
    <link rel="stylesheet" href="~/assets/css/socialv.css?v=4.0.0">
    <link rel="stylesheet" href="~/assets/vendor/_fortawesome/fontawesome-free/css/all.min.css">
    <link rel="stylesheet" href="~/assets/vendor/remixicon/fonts/remixicon.css">
    <link rel="stylesheet" href="~/assets/vendor/vanillajs-datepicker/dist/css/datepicker.min.css">
    <link rel="stylesheet" href="~/assets/vendor/line-awesome/dist/font-awesome-line-awesome/css/all.min.css">
    <link rel="stylesheet" href="~/assets/vendor/line-awesome/dist/line-awesome/css/line-awesome.min.css">
    <link rel="stylesheet" href="./css/font-awesome.css">
    <link rel="stylesheet" href="~/css/site.css" />
    <link rel="stylesheet" type="text/css" href="./css/slick.css" />
    <link rel="stylesheet" type="text/css" href="./css/slick-theme.css" />
    <script src="./js/signalR.js"></script>
    <script src="./js/jquery.js"></script>

    <script src="./js/toast.js"></script>
    <link rel="stylesheet" href="~/css/site.css"/>
</head>
<body>
@*     <header>
    <nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white border-bottom box-shadow mb-3">
    <div class="container">
    <a class="navbar-brand" asp-area="" asp-page="/Index">PRN221_Assignment</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target=".navbar-collapse" aria-controls="navbarSupportedContent"
    aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
    </button>
    <div class="navbar-collapse collapse d-sm-inline-flex justify-content-between">
    <ul class="navbar-nav flex-grow-1">
    <li class="nav-item">
    <a class="nav-link text-dark" asp-area="" asp-page="/Index">Home</a>
    </li>
    <li class="nav-item">
    <a class="nav-link text-dark" asp-area="" asp-page="/Privacy">Privacy</a>
    </li>
    </ul>
    <partial name="_LoginPartial" />
    </div>
    </div>
    </nav>
    </header> *@

<div>
<!-- loader Start -->
<div id="loading">
    <div id="loading-center">
    </div>
</div>
<!-- loader END -->
<!-- Wrapper Start -->
<div class="wrapper">
<div class="iq-sidebar sidebar-default ">
<div id="sidebar-scrollbar">
<nav class="iq-sidebar-menu">
<ul id="iq-sidebar-toggle" class="iq-menu">
<li class="active">
    <a href="~/dashboard/index.html" class=" ">
        <i class="las la-newspaper"></i><span>Newsfeed</span>
    </a>
</li>
<li class="">
    <a href="/Profile?Id=@User.FindFirstValue(ClaimTypes.NameIdentifier)" class=" ">
        <i class="las la-user"></i><span>Profile</span>
    </a>
</li>
<li class="">
    <a href="~/app/group.html" class=" ">
        <i class="las la-users"></i><span>Group</span>
    </a>
</li>
<li class=" ">
    <a href="~/app/todo.html" class=" ">
        <i class="las la-check-circle"></i><span>Todo</span>
    </a>
</li>
<li class=" ">
    <a href="~/dashboard/calendar.html" class=" ">
        <i class="las la-calendar"></i><span>Calendar</span>
    </a>
</li>
<li class=" ">
    <a href="#mailbox" data-bs-toggle="collapse" class="  collapsed" aria-expanded="false">
        <i class="ri-mail-line"></i><span>Email</span><i class="ri-arrow-right-s-line iq-arrow-right"></i>
    </a>
    <ul id="mailbox" class="iq-submenu collapse" data-bs-parent="#iq-sidebar-toggle">
        <li class="">
            <a href="~/app/email.html"><i class="  ri-inbox-line"></i>Inbox</a>
        </li>
        <li class="">
            <a href="~/app/email-compose.html"><i class="ri-edit-line"></i>Email Compose</a>
        </li>
    </ul>
</li>

<li class="">
    <a href="#ui-elements" data-bs-toggle="collapse" class="  collapsed"
       aria-expanded="false">
        <i class="ri-focus-2-line"></i><span>Ui-Elements</span><i class="ri-arrow-right-s-line iq-arrow-right"></i>
    </a>
    <ul id="ui-elements" class="iq-submenu collapse"
        data-bs-parent="#iq-sidebar-toggle">
        <li class="">
            <a href="#ui-kit" data-bs-toggle="collapse" class="  collapsed"
               aria-expanded="false">
                <i class="ri-pencil-ruler-line"></i><span>UI Kit</span><i class="ri-arrow-right-s-line iq-arrow-right"></i>
            </a>
            <ul id="ui-kit" class="iq-submenu collapse" data-bs-parent="#ui-elements">
                <li class="">
                    <a href="~/dashboard/ui-color.html"><i class="ri-font-color"></i>Colors</a>
                </li>
                <li class=" ">
                    <a href="~/dashboard/ui-typography.html"><i class="ri-text"></i>Typography</a>
                </li>
                <li class="">
                    <a href="~/dashboard/ui-alerts.html"><i class="ri-alert-line"></i>Alerts</a>
                </li>
                <li class="">
                    <a href="~/dashboard/ui-badges.html"><i class="ri-building-3-line"></i>Badges</a>
                </li>
                <li class="">
                    <a href="~/dashboard/ui-breadcrumb.html"><i class="ri-menu-2-line"></i>Breadcrumb</a>
                </li>
                <li class="">
                    <a href="~/dashboard/ui-buttons.html"><i class="ri-checkbox-blank-line"></i>Buttons</a>
                </li>
                <li class="">
                    <a href="~/dashboard/ui-cards.html"><i class="ri-bank-card-line"></i>Cards</a>
                </li>
                <li class="">
                    <a href="~/dashboard/ui-carousel.html"><i class="ri-slideshow-line"></i>Carousel</a>
                </li>
                <li class="">
                    <a href="~/dashboard/ui-embed-video.html"><i class="ri-slideshow-2-line"></i>Video</a>
                </li>
                <li class="">
                    <a href="~/dashboard/ui-grid.html"><i class="ri-grid-line"></i>Grid</a>
                </li>
                <li class="">
                    <a href="~/dashboard/ui-images.html"><i class="ri-image-line"></i>Images</a>
                </li>
                <li class="">
                    <a href="~/dashboard/ui-list-group.html">
                        <i class="ri-file-list-3-line"></i>list
                        Group
                    </a>
                </li>
                <li class="">
                    <a href="~/dashboard/ui-modal.html"><i class="ri-stop-mini-line"></i>Modal</a>
                </li>
                <li class="">
                    <a href="~/dashboard/ui-notifications.html"><i class="ri-notification-line"></i>Notifications</a>
                </li>
                <li class="">
                    <a href="ui-pagination.html"><i class="ri-pages-line"></i>Pagination</a>
                </li>
                <li class="">
                    <a href="~/dashboard/ui-popovers.html"><i class="ri-folder-shield-2-line"></i>Popovers</a>
                </li>
                <li class="">
                    <a href="~/dashboard/ui-progressbars.html"><i class="ri-battery-low-line"></i>Progressbars</a>
                </li>
                <li class="">
                    <a href="~/dashboard/ui-tabs.html"><i class="ri-database-line"></i>Tabs</a>
                </li>
                <li class="">
                    <a href="~/dashboard/ui-tooltips.html"><i class="ri-record-mail-line"></i>Tooltips</a>
                </li>
            </ul>
        </li>
        <li class="">
            <a href="#forms" class="  collapsed" data-bs-toggle="collapse"
               aria-expanded="false">
                <i class="ri-profile-line"></i><span>Forms</span><i class="ri-arrow-right-s-line iq-arrow-right"></i>
            </a>
            <ul id="forms" class="iq-submenu collapse" data-bs-parent="#ui-elements">
                <li class="">
                    <a href="~/dashboard/form-layout.html"><i class="ri-tablet-line"></i>Form Elements</a>
                </li>
                <li class="">
                    <a href="~/dashboard/form-validation.html">
                        <i class="ri-device-line"></i>Form
                        Validation
                    </a>
                </li>
                <li class="">
                    <a href="~/dashboard/form-switch.html"><i class="ri-toggle-line"></i>Form Switch</a>
                </li>
                <li class="">
                    <a href="~/dashboard/form-chechbox.html">
                        <i class="ri-checkbox-line"></i>Form
                        Checkbox
                    </a>
                </li>
                <li class="">
                    <a href="~/dashboard/form-radio.html"><i class="ri-radio-button-line"></i>Form Radio</a>
                </li>
            </ul>
        </li>
        <li class="">
            <a href="#wizard-form" class="  collapsed" data-bs-toggle="collapse"
               aria-expanded="false">
                <i class="ri-archive-drawer-line"></i>
                <span>
                    Forms
                    Wizard
                </span><i class="ri-arrow-right-s-line iq-arrow-right"></i>
            </a>
            <ul id="wizard-form" class="iq-submenu collapse" data-bs-parent="#ui-elements">
                <li class="">
                    <a href="~/dashboard/form-wizard.html"><i class="ri-clockwise-line"></i>Simple Wizard</a>
                </li>
                <li class="">
                    <a href="~/dashboard/form-wizard-validate.html"><i class="ri-clockwise-2-line"></i>Validate Wizard</a>
                </li>
                <li class="">
                    <a href="~/dashboard/form-wizard-vertical.html"><i class="ri-anticlockwise-line"></i>Vertical Wizard</a>
                </li>
            </ul>
        </li>
        <li class="">
            <a href="#tables" class="  collapsed" data-bs-toggle="collapse"
               aria-expanded="false">
                <i class="ri-table-line"></i><span>Table</span><i class="ri-arrow-right-s-line iq-arrow-right"></i>
            </a>
            <ul id="tables" class="iq-submenu collapse" data-bs-parent="#ui-elements">
                <li class="">
                    <a href="~/dashboard/tables-basic.html"><i class="ri-table-line"></i>Basic Tables</a>
                </li>
                <li class="">
                    <a href="~/dashboard/data-table.html"><i class="ri-database-line"></i>Data Table</a>
                </li>
                <li class="">
                    <a href="~/dashboard/table-editable.html"><i class="ri-refund-line"></i>Editable Table</a>
                </li>
            </ul>
        </li>
        <li class="">
            <a href="#icons" class="  collapsed" data-bs-toggle="collapse"
               aria-expanded="false">
                <i class="ri-list-check"></i><span>Icons</span><i class="ri-arrow-right-s-line iq-arrow-right"></i>
            </a>
            <ul id="icons" class="iq-submenu collapse" data-bs-parent="#ui-elements">
                <li class="">
                    <a href="~/dashboard/icon-fontawesome-5.html"><i class="ri-facebook-fill"></i>Font Awesome 5</a>
                </li>
                <li class="">
                    <a href="~/dashboard/icon-lineawesome.html"><i class="ri-keynote-line"></i>line Awesome</a>
                </li>
                <li class="">
                    <a href="~/dashboard/icon-remixicon.html"><i class="ri-remixicon-line"></i>Remixicon</a>
                </li>
            </ul>
        </li>
    </ul>
</li>
<li class="">
    <a href="#pages" class="  collapsed" data-bs-toggle="collapse"
       aria-expanded="false">
        <i class="ri-pages-line"></i><span>Pages</span><i class="ri-arrow-right-s-line iq-arrow-right"></i>
    </a>
    <ul id="pages" class="iq-submenu collapse" data-bs-parent="#iq-sidebar-toggle">
        <li class="">
            <a href="#authentication" class="  collapsed" data-bs-toggle="collapse"
               aria-expanded="false">
                <i class="ri-pages-line"></i><span>Authentication</span><i class="ri-arrow-right-s-line iq-arrow-right"></i>
            </a>
            <ul id="authentication" class="iq-submenu collapse" data-bs-parent="#pages">
                <li class="">
                    <a href="~/dashboard/sign-in.html"><i class="ri-login-box-line"></i>Login</a>
                </li>
                <li class="">
                    <a href="~/dashboard/sign-up.html"><i class="ri-login-circle-line"></i>Register</a>
                </li>
                <li class="">
                    <a href="~/dashboard/pages-recoverpw.html"><i class="ri-record-mail-line"></i>Recover Password</a>
                </li>
                <li class="">
                    <a href="~/dashboard/pages-confirm-mail.html"><i class="ri-file-code-line"></i>Confirm Mail</a>
                </li>
                <li class="">
                    <a href="~/dashboard/pages-lock-screen.html"><i class="ri-lock-line"></i>Lock Screen</a>
                </li>
            </ul>
        </li>
        <li class="">
            <a href="#extra-pages" class="  collapsed" data-bs-toggle="collapse"
               aria-expanded="false">
                <i class="ri-pantone-line"></i><span>Extra Pages</span><i class="ri-arrow-right-s-line iq-arrow-right"></i>
            </a>
            <ul id="extra-pages" class="iq-submenu collapse" data-bs-parent="#pages">
                <li class="">
                    <a href="~/dashboard/pages-timeline.html"><i class="ri-map-pin-time-line"></i>Timeline</a>
                </li>
                <li class="">
                    <a href="~/dashboard/pages-invoice.html"><i class="ri-question-answer-line"></i>Invoice</a>
                </li>
                <li class="">
                    <a href="~/dashboard/blank-page.html"><i class="ri-invision-line"></i>Blank Page</a>
                </li>
                <li class="">
                    <a href="~/dashboard/pages-error.html"><i class="ri-error-warning-line"></i>Error 404</a>
                </li>
                <li class="">
                    <a href="~/dashboard/pages-error-500.html"><i class="ri-error-warning-line"></i>Error 500</a>
                </li>
                <li class="">
                    <a href="~/dashboard/pages-pricing.html"><i class="ri-price-tag-line"></i>Pricing</a>
                </li>
                <li class="">
                    <a href="~/dashboard/pages-pricing-one.html"><i class="ri-price-tag-2-line"></i>Pricing 1</a>
                </li>
                <li class="">
                    <a href="~/dashboard/pages-maintenance.html"><i class="ri-archive-line"></i>Maintenance</a>
                </li>
                <li class="">
                    <a href="~/dashboard/pages-comingsoon.html"><i class="ri-mastercard-line"></i>Coming Soon</a>
                </li>
                <li class="">
                    <a href="~/dashboard/pages-faq.html"><i class="ri-compasses-line"></i>Faq</a>
                </li>
            </ul>
        </li>
    </ul>
</li>
</ul>
</nav>
<div class="p-5"></div>
</div>
</div>

<div class="iq-top-navbar">
<div class="iq-navbar-custom">
<nav class="navbar navbar-expand-lg navbar-light p-0">
<div class="iq-navbar-logo d-flex justify-content-between">
    <a href="/Index">
        <img src="~/assets/images/logo.png" class="img-fluid" alt="">
        <span>SocialV</span>
    </a>
    <div class="iq-menu-bt align-self-center">
        <div class="wrapper-menu">
            <div class="main-circle">
                <i class="ri-menu-line"></i>
            </div>
        </div>
    </div>
</div>
<div class="iq-search-bar device-search">
    <form class="searchbox" method="post" asp-page="/Search">
        <a class="search-link" href="#">
            <i class="ri-search-line"></i>
        </a>
        <input type="text" name="searchTerm" class="text search-input" placeholder="Search here...">
        <input type="hidden" name="SeeAll" value="false">
    </form>
</div>
<button class="navbar-toggler" type="button" data-bs-toggle="collapse"
        data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
        aria-label="Toggle navigation">
    <i class="ri-menu-3-line"></i>
</button>
<div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav  ms-auto navbar-list">
        <li>
            <a href="~/" class="  d-flex align-items-center">
                <i class="ri-home-line"></i>
            </a>
        </li>
            <li onclick="fetchFriendRequests()" class="nav-item dropdown">
            <a href="#" class="dropdown-toggle" id="group-drop" data-bs-toggle="dropdown"
               aria-haspopup="true" aria-expanded="false">
                <i class="ri-group-line"></i>
                <h1 class="notification-badge request-noti"></h1>
            </a>
            <div class="sub-drop sub-drop-large dropdown-menu" aria-labelledby="group-drop">
                <div class="card shadow-none m-0">
                    <div class="card-header d-flex justify-content-between bg-primary">
                        <div class="header-title">
                            <h5 class="mb-0 text-white">Friend Request</h5>
                        </div>
                        <small class="badge req-count bg-light text-dark "></small>
                    </div>
                    <div class="card-body p-0 request-list">
                        @* <div class="text-center"> *@
                        @*     <a href="#" class=" btn text-primary">View More Request</a> *@
                        @* </div> *@
                    </div>
                </div>
            </div>
        </li>
        <li class="nav-item dropdown">
                 <a onclick="fetchFriendRequestOtherNoti().then(() => updateNotificationBadgeG());" href="#" class="search-toggle dropdown-toggle" id="notification-drop" data-bs-toggle="dropdown">
                <i class="ri-notification-4-line"></i>
                <h1 class="notification-badge noti-noti"></h1>
            </a>
            <div class="sub-drop dropdown-menu" aria-labelledby="notification-drop">
                <div class="card shadow-none m-0">
                    <div class="card-header d-flex justify-content-between bg-primary">
                        <div class="header-title bg-primary">
                            <h5 class="mb-0 text-white">All Notifications</h5>
                        </div>
                        <small class="badge bg-light text-dark noti-count"></small>
                    </div>
                    <div class="card-body p-0 noti-list">
                        @*<a href="#" class="iq-sub-card">
                            <div class="d-flex align-items-center">
                                <div class="">
                                    <img class="avatar-40 rounded" src="~/assets/images/user/01.jpg" alt="">
                                </div>
                                <div class="ms-3 w-100">
                                    <h6 class="mb-0 ">Emma Watson Bni</h6>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <p class="mb-0">accepted your friend request</p>
                                        <small class="float-right font-size-12">Just Now</small>
                                    </div>
                                </div>
                            </div>
                        </a>
                        <a href="#" class="iq-sub-card">
                            <div class="d-flex align-items-center">
                                <div class="">
                                    <img class="avatar-40 rounded" src="~/assets/images/user/02.jpg" alt="">
                                </div>
                                <div class="ms-3 w-100">
                                    <h6 class="mb-0 ">New customer is join</h6>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <p class="mb-0">Cyst Bni</p>
                                        <small class="float-right font-size-12">5 days ago</small>
                                    </div>
                                </div>
                            </div>
                        </a>
                        <a href="#" class="iq-sub-card">
                            <div class="d-flex align-items-center">
                                <div class="">
                                    <img class="avatar-40 rounded" src="~/assets/images/user/03.jpg" alt="">
                                </div>
                                <div class="ms-3 w-100">
                                    <h6 class="mb-0 ">Two customer is left</h6>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <p class="mb-0">Cyst Bni</p>
                                        <small class="float-right font-size-12">2 days ago</small>
                                    </div>
                                </div>
                            </div>
                        </a>
                        <a href="#" class="iq-sub-card">
                            <div class="d-flex align-items-center">
                                <div class="">
                                    <img class="avatar-40 rounded" src="~/assets/images/user/04.jpg" alt="">
                                </div>
                                <div class="w-100 ms-3">
                                    <h6 class="mb-0 ">New Mail from Fenny</h6>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <p class="mb-0">Cyst Bni</p>
                                        <small class="float-right font-size-12">3 days ago</small>
                                    </div>
                                </div>
                            </div>
                        </a>*@
                    </div>
                </div>
            </div>
        </li>
        <li class="nav-item dropdown">
            <a href="#" class="dropdown-toggle" id="listMess" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" onclick="fetchListMess();">
                <i class="ri-message-line"></i>
                <h1 class="notification-badge message-noti"></h1>
            </a>
            <div class="sub-drop dropdown-menu" aria-labelledby="mail-drop" style="box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2)">
                <div class="card shadow-none m-0">
                    <div class="card-header d-flex justify-content-between bg-primary">
                        <div class="header-title bg-primary d-flex justify-content-between align-items-center w-100">
                            <h5 class="mb-0 text-white">All Messages</h5>
                            <span class="ml-auto text-white unrep"></span>
                        </div>
                    </div>
                    <div class="card-body p-0 chat-noti">
                    </div>
                </div>
            </div>
        </li>
        <li class="nav-item">
            <a style="color:#50b5FF">
                <i id="changeView" class="ri-sun-line" onclick="toggleDarkMode()"></i>
            </a>
        </li>
        @if (User.Identity.IsAuthenticated)
        {
            <li class="nav-item dropdown">
                <a href="#" class="  d-flex align-items-center dropdown-toggle" id="drop-down-arrow" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <img src="@User.FindFirstValue("profile_picture")" class="img-fluid rounded-circle me-3" alt="user">
                    <div class="caption">
                        <h6 class="mb-0 line-height">@User.FindFirstValue(ClaimTypes.GivenName)</h6>
                    </div>
                </a>
                <div class="sub-drop dropdown-menu caption-menu" aria-labelledby="drop-down-arrow">
                    <div class="card shadow-none m-0">
                        <div class="card-header  bg-primary">
                            <div class="header-title">
                                <h5 class="mb-0 text-white">Hello @User.FindFirstValue(ClaimTypes.GivenName)</h5>
                                <span class="text-white font-size-12">Available</span>
                            </div>
                        </div>
                        <div class="card-body p-0 ">
                            <a href="/Profile?Id=@User.FindFirstValue(ClaimTypes.NameIdentifier)" class="iq-sub-card iq-bg-primary-hover">
                                <div class="d-flex align-items-center">
                                    <div class="rounded card-icon bg-soft-primary">
                                        <i class="ri-file-user-line"></i>
                                    </div>
                                    <div class="ms-3">
                                        <h6 class="mb-0 ">My Profile</h6>
                                        <p class="mb-0 font-size-12">View personal profile details.</p>
                                    </div>
                                </div>
                            </a>
                            @* <a href="~/app/profile-edit.html" class="iq-sub-card iq-bg-warning-hover"> *@
                            @*     <div class="d-flex align-items-center"> *@
                            @*         <div class="rounded card-icon bg-soft-warning"> *@
                            @*             <i class="ri-profile-line"></i> *@
                            @*         </div> *@
                            @*         <div class="ms-3"> *@
                            @*             <h6 class="mb-0 ">Edit Profile</h6> *@
                            @*             <p class="mb-0 font-size-12">Modify your personal details.</p> *@
                            @*         </div> *@
                            @*     </div> *@
                            @* </a> *@
                            @* <a href="~/app/account-setting.html" class="iq-sub-card iq-bg-info-hover"> *@
                            @*     <div class="d-flex align-items-center"> *@
                            @*         <div class="rounded card-icon bg-soft-info"> *@
                            @*             <i class="ri-account-box-line"></i> *@
                            @*         </div> *@
                            @*         <div class="ms-3"> *@
                            @*             <h6 class="mb-0 ">Account settings</h6> *@
                            @*             <p class="mb-0 font-size-12">Manage your account parameters.</p> *@
                            @*         </div> *@
                            @*     </div> *@
                            @* </a> *@
                            @* <a href="~/app/privacy-setting.html" class="iq-sub-card iq-bg-danger-hover"> *@
                            @*     <div class="d-flex align-items-center"> *@
                            @*         <div class="rounded card-icon bg-soft-danger"> *@
                            @*             <i class="ri-lock-line"></i> *@
                            @*         </div> *@
                            @*         <div class="ms-3"> *@
                            @*             <h6 class="mb-0 ">Privacy Settings</h6> *@
                            @*             <p class="mb-0 font-size-12"> *@
                            @*                 Control your privacy parameters. *@
                            @*             </p> *@
                            @*         </div> *@
                            @*     </div> *@
                            @* </a> *@
                            <div class="d-inline-block w-100 text-center p-3">
                                <a asp-page="/Login" asp-page-handler="Logout" class="btn btn-primary iq-sign-btn" role="button">
                                    Sign out<i class="ri-login-box-line ms-2"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </li>
        }
    </ul>
</div>
</nav>
</div>
</div>

@RenderBody()


<!-- offcanvas start -->

<div class="offcanvas offcanvas-bottom share-offcanvas" tabindex="-1" id="share-btn" aria-labelledby="shareBottomLabel">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="shareBottomLabel">Share</h5>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body small">
        <div class="d-flex flex-wrap align-items-center">
            <div class="text-center me-3 mb-3">
                <img src="~/assets/images/icon/08.png" class="img-fluid rounded mb-2" alt="">
                <h6>Facebook</h6>
            </div>
            <div class="text-center me-3 mb-3">
                <img src="~/assets/images/icon/09.png" class="img-fluid rounded mb-2" alt="">
                <h6>Twitter</h6>
            </div>
            <div class="text-center me-3 mb-3">
                <img src="~/assets/images/icon/10.png" class="img-fluid rounded mb-2" alt="">
                <h6>Instagram</h6>
            </div>
            <div class="text-center me-3 mb-3">
                <img src="~/assets/images/icon/11.png" class="img-fluid rounded mb-2" alt="">
                <h6>Google Plus</h6>
            </div>
            <div class="text-center me-3 mb-3">
                <img src="~/assets/images/icon/13.png" class="img-fluid rounded mb-2" alt="">
                <h6>In</h6>
            </div>
            <div class="text-center me-3 mb-3">
                <img src="~/assets/images/icon/12.png" class="img-fluid rounded mb-2" alt="">
                <h6>YouTube</h6>
            </div>
        </div>
    </div>
</div>
<div id="chatContainer" style="position: fixed; bottom: 0; right: 300px; display: flex"></div>

@* <div class="chat-box" id="chatBox">
            <div class="chat-header" id="chatHeader">
            <span id="chatWith">Chat with</span>
            <button class="close-button" onclick="closeChat()">×</button>
            </div>
            <div class="chat-messages" id="messagesList">
            <!-- Messages will appear here -->
            </div>
            <div class="chat-input">
            <input type="text" id="messageInput" placeholder="Type a message..." />
            <button onclick="sendMessage()">Send</button>
            </div>
            </div> *@
</div>
<script src="./js/DarkModeManager.js"></script>
<script>

            ////////////////////////////
            document.addEventListener('click', function (event) {
                const chatNotiDropdown = event.target.closest('.chat-noti');
                if (chatNotiDropdown) {
                    closeAllDropdowns();
                }
            });
            
            document.addEventListener('DOMContentLoaded', function () {

                document.body.addEventListener('click', function (event) {
////////////////////////////Handle Friend Request Action
                    if (event.target.classList.contains('add-friend')) {
                        handleAddFriend(event.target);
                    }

                    if (event.target.classList.contains('cancel-friend')) {
                        handleCancelFriend(event.target);
                    }

                    if (event.target.classList.contains('accept-friend')) {
                        handleAcceptFriend(event.target);
                    }
/////////////////////////////
                    // Handle dropdown toggle click
                    if (event.target.closest('.dropdown-toggle')) {
                        toggleDropdown(event.target.closest('.dropdown-toggle'));
                    }
                });

                document.body.addEventListener('click', function (event) {
                    // Close all dropdowns if click is outside
                    if (!event.target.closest('.dropdown')) {
                        closeAllDropdowns();
                    }
                });
            });
            //FriendRequest-js


            function toggleDropdown(dropdownToggle) {
                const dropdownMenu = dropdownToggle.nextElementSibling;
                dropdownMenu.classList.toggle('show');

                document.querySelectorAll('.dropdown-menu.show').forEach((menu) => {
                    if (menu !== dropdownMenu) {
                        menu.classList.remove('show');
                    }
                });
            }

            function closeAllDropdowns() {
                document.querySelectorAll('.dropdown-menu.show').forEach((menu) => {
                    menu.classList.remove('show');
                });
            }

        </script>

</div>


<footer class="border-top footer text-muted">
    <div class="container">
        &copy; 2024 - PRN221_Assignment - <a asp-area="" asp-page="/Privacy">Privacy</a>
    </div>
</footer>


<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="~/js/site.js" asp-append-version="true"></script>
<!-- Wrapper End-->
<!-- Backend Bundle JavaScript -->
<script src="~/assets/js/libs.min.js"></script>
 <script type="text/javascript" src="./js/slick.min.js"></script>

<!-- slider JavaScript -->
<script src="~/assets/js/slider.js"></script>
<!-- masonry JavaScript -->
<script src="~/assets/js/masonry.pkgd.min.js"></script>
<!-- SweetAlert JavaScript -->
<script src="~/assets/js/enchanter.js"></script>
<!-- SweetAlert JavaScript --><!-- app JavaScript -->
<script src="~/assets/js/app.js"></script>
<script src="~/assets/vendor/vanillajs-datepicker/dist/js/datepicker.min.js"></script>
<script src="~/assets/js/lottie.js"></script>
@await RenderSectionAsync("Scripts", required: false)
</body>

<script>
    const CURRENT_USER_ID = '@User.FindFirstValue(ClaimTypes.NameIdentifier)';
    const CURRENT_USER_NAME = '@User.FindFirstValue(ClaimTypes.GivenName)';
    const CURRENT_USER_IMAGE ='@User.FindFirstValue("profile_picture")';
    const body = document.body;
    

    

    // Automatically load listMess when the page is ready

    // Function to limit the content length to 10 characters and add ellipsis
    function limitContent(content, maxLength = 20) {
        if (content.length > maxLength) {
            return content.substring(0, 10) + '...';
        }
        return content;
    }


    function getTimeFromMessage(timeString) {
        const time = new Date(timeString);
        const now = new Date();

        const diffInSeconds = Math.floor((now - time) / 1000);
        const diffInMinutes = Math.floor(diffInSeconds / 60);
        const diffInHours = Math.floor(diffInMinutes / 60);
        const diffInDays = Math.floor(diffInHours / 24);
        const diffInWeeks = Math.floor(diffInDays / 7);
        const diffInYears = Math.floor(diffInDays / 365);

        if (diffInSeconds < 60) {
            return `${diffInSeconds} second${diffInSeconds === 1 ? '' : 's'} ago`;
        } else if (diffInMinutes < 60) {
            return `${diffInMinutes} minute${diffInMinutes === 1 ? '' : 's'} ago`;
        } else if (diffInHours < 24) {
            return `${diffInHours} hour${diffInHours === 1 ? '' : 's'} ago`;
        } else if (diffInDays < 7) {
            return `${diffInDays} day${diffInDays === 1 ? '' : 's'} ago`;
        } else if (diffInDays < 365) {
            return `${diffInWeeks} week${diffInWeeks === 1 ? '' : 's'} ago`;
        } else {
            return `${diffInYears} year${diffInYears === 1 ? '' : 's'} ago`;
        }
    }


    ///////////////chatbox

   

    function updateNotificationBadgeG() {
        const number = document.querySelectorAll(".noti-list .iq-sub-card").length ?? 0;
        if (number ==0) document.querySelector(".noti-noti").style.display = 'none';
        document.querySelector(".noti-count").innerHTML = number;
        document.querySelector(".noti-noti").innerHTML = number;
    }

    function updateNotificationBadgeM() {
        const number = document.querySelector(".req-count").textContent ?? 0;
        document.querySelector(".request-noti").innerHTML = number;
    }

    function redirectToProfile(userId) {
        window.location.href = '/Profile?Id=' + userId;
    }

 

</script>



</html>
<script src="./js/connection.js"></script>
<script src="./js/ConnectionHandler/ConnectionHandler.js"></script>
<script src="./js/chatbox/chatBoxHandler.js"></script>
<script src="./js/Post/commentHandler.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', (event) => {
        fetchListMess();
        fetchFriendRequests().then(() => updateNotificationBadgeM());
        fetchFriendRequestOtherNoti(CURRENT_USER_ID).then(() => updateNotificationBadgeG());
        updateNotificationBadgeM();
    });
</script>


